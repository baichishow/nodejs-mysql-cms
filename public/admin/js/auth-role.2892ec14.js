"use strict";(self["webpackChunkvue_cms_admin"]=self["webpackChunkvue_cms_admin"]||[]).push([[617],{1612:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("div",[t("el-row",[t("el-col",{attrs:{span:16}},[t("el-card",{staticClass:"table-card"},[t("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("管理员角色")]),t("el-button",{attrs:{icon:"el-icon-circle-plus-outline",plain:"",type:"primary"},on:{click:function(t){e.insert_dialog_visible=!0}}},[e._v(" 添加角色 ")])],1),t("el-table",{attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"role_id",label:"#",width:"60"}}),t("el-table-column",{attrs:{prop:"role_name",label:"角色名称"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",[e._v(e._s(i.row.role_name))])]}}])}),t("el-table-column",{attrs:{prop:"role_code",label:"角色代码"}}),t("el-table-column",{attrs:{prop:"role_description",label:"角色描述"}}),t("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{disabled:0===i.row.editable,icon:"el-icon-edit",plain:"",type:"primary"},on:{click:function(t){return e.openEditDialog(i.row,i.$index)}}}),t("el-button",{attrs:{disabled:0===i.row.editable,icon:"el-icon-delete",plain:"",type:"danger"},on:{click:function(t){return e.handleRemoveRole(i.row.role_id,i.$index)}}}),t("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-setting"},on:{click:function(t){return e.openSettingDrawer(i.row.role_id)}}})]}}])})],1)],1)],1)],1),t("el-dialog",{attrs:{title:"添加角色",visible:e.insert_dialog_visible},on:{"update:visible":function(t){e.insert_dialog_visible=t},close:function(t){return e.handleDialogClose("insert_form")}}},[t("el-form",{ref:"insert_form",attrs:{rules:e.rules,model:e.insert_form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"角色名称",prop:"role_name"}},[t("el-input",{model:{value:e.insert_form.role_name,callback:function(t){e.$set(e.insert_form,"role_name",t)},expression:"insert_form.role_name"}})],1),t("el-form-item",{attrs:{label:"角色代码",prop:"role_code"}},[t("el-input",{attrs:{placeholder:"请输入大写英文的角色代码"},model:{value:e.insert_form.role_code,callback:function(t){e.$set(e.insert_form,"role_code",t)},expression:"insert_form.role_code"}})],1),t("el-form-item",{attrs:{label:"角色描述",prop:"role_description"}},[t("el-input",{attrs:{placeholder:"请输入角色的说明文字"},model:{value:e.insert_form.role_description,callback:function(t){e.$set(e.insert_form,"role_description",t)},expression:"insert_form.role_description"}})],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.insert_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleInsertRole}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"编辑角色",visible:e.edit_dialog_visible},on:{"update:visible":function(t){e.edit_dialog_visible=t},close:function(t){return e.handleDialogClose("edit_form")}}},[t("el-form",{ref:"edit_form",attrs:{rules:e.rules,model:e.edit_form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"角色名称",prop:"role_name"}},[t("el-input",{model:{value:e.edit_form.role_name,callback:function(t){e.$set(e.edit_form,"role_name",t)},expression:"edit_form.role_name"}})],1),t("el-form-item",{attrs:{label:"角色代码",prop:"role_code"}},[t("el-input",{attrs:{placeholder:"请输入大写英文的角色代码"},model:{value:e.edit_form.role_code,callback:function(t){e.$set(e.edit_form,"role_code",t)},expression:"edit_form.role_code"}})],1),t("el-form-item",{attrs:{label:"角色描述",prop:"role_description"}},[t("el-input",{attrs:{placeholder:"请输入角色的说明文字"},model:{value:e.edit_form.role_description,callback:function(t){e.$set(e.edit_form,"role_description",t)},expression:"edit_form.role_description"}})],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.edit_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleEditRole}},[e._v("保 存")])],1)],1),t("el-dialog",{attrs:{title:"设置角色权限",visible:e.setting_visible},on:{"update:visible":function(t){e.setting_visible=t}}},[t("el-steps",{attrs:{active:e.current_step,"finish-status":"success","align-center":""}},[t("el-step",{attrs:{title:"路由权限"}}),t("el-step",{attrs:{title:"菜单、操作权限"}})],1),t("el-tree",{directives:[{name:"show",rawName:"v-show",value:0===e.current_step,expression:"current_step===0"}],ref:"route_tree",attrs:{data:e.route_tree,"check-strictly":e.check_strictly,"show-checkbox":"","highlight-current":"","default-expand-all":"","node-key":"menu_id",props:e.route_props}}),t("el-tree",{directives:[{name:"show",rawName:"v-show",value:1===e.current_step,expression:"current_step===1"}],ref:"menu_tree",attrs:{data:e.menu_tree,"check-strictly":e.check_strictly,"show-checkbox":"","highlight-current":"","default-expand-all":"","node-key":"menu_id",props:e.menu_props}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)],1),t("el-drawer",{attrs:{title:"设置角色菜单",size:"25%",direction:"rtl"},on:{open:e.handleSetCheckedMenu,close:function(t){e.check_strictly=!0}}},[t("div",{staticClass:"am-padding-horizontal-xl setting-card"},[t("div",{staticClass:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSetRoleMenu}},[e._v("保存")]),t("el-button",{on:{click:function(t){e.setting_visible=!1}}},[e._v("取消")])],1)])])],1)},l=[],s=(i(7658),i(1803)),o={name:"Role",data(){return{tableData:[],insert_dialog_visible:!1,edit_dialog_visible:!1,setting_visible:!1,insert_form:{role_name:"",role_code:"",role_description:""},edit_form:{role_id:"",role_name:"",role_code:"",role_description:""},current_index:"",current_role_id:"",rules:{role_name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],role_code:[{required:!0,message:"请输入大写英文的角色代码",trigger:"blur"}],role_description:[{required:!0,message:"请输入角色的说明文字",trigger:"blur"}]},current_step:0,route_tree:[],menu_tree:[],check_strictly:!0,route_props:{label:"permission_remark"},menu_props:{label:"menu_name"}}},created(){document.title="管理员角色",this.loadRoleList(),this.loadRouteList(),this.loadMenuList()},methods:{async loadRoleList(){let{status:e,data:t}=await s.uU.list();e&&(this.tableData=t)},openEditDialog(e,t){this.edit_form={...e},this.edit_dialog_visible=!0,this.current_index=t},handleEditRole(){this.$refs.edit_form.validate((async e=>{if(e){let{status:e,msg:t}=await s.uU.edit(this.edit_form.role_id,{...this.edit_form});e?(this.$set(this.tableData,this.current_index,{...this.edit_form}),this.$message.success(t),this.edit_dialog_visible=!1):this.$message.error(t)}}))},async handleRemoveRole(e,t){this.$confirm("此操作将永久删除该角色, 是否继续?",{type:"warning"}).then((async()=>{let{status:i,msg:r}=await s.uU.remove(e);i?(this.tableData.splice(t,1),this.$message.success(r)):this.$message.error(r)})).catch((()=>{this.$message.info("取消成功！")}))},handleInsertRole(){this.$refs.insert_form.validate((async e=>{if(e){let{status:e,msg:t,data:i}=await s.uU.insert({...this.insert_form});e&&(this.tableData.push({...i,...this.insert_form}),this.insert_dialog_visible=!1)}}))},handleDialogClose(e){this.$refs[e].resetFields()},async loadRouteList(){let{status:e,data:t}=await s.AW.loadAll({type:"tree"});e&&(this.route_tree=t)},async loadMenuList(){let{status:e,data:t}=await s.v2.loadAll({type:"tree"});e&&(this.menu_tree=t)},async openSettingDrawer(e){this.setting_visible=!0,this.current_role_id=e},async handleSetCheckedMenu(){let{status:e,data:t}=await s.uU.menu({role_id:this.current_role_id,type:"flat"});if(e){let e=t.map((e=>e.id));this.$refs.tree.setCheckedKeys(e),this.check_strictly=!1}},async handleSetRoleMenu(){let e=this.$refs.tree.getCheckedNodes(!1,!0),t=e.map((e=>e.id)),{status:i,msg:r}=await s.uU.setMenu({id:this.current_role_id,menus:t});i?(this.$message.success(r),this.setting_visible=!1):this.$message.error(r)}}},a=o,n=i(1001),c=(0,n.Z)(a,r,l,!1,null,null,null),d=c.exports}}]);
//# sourceMappingURL=auth-role.2892ec14.js.map
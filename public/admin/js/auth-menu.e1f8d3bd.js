"use strict";(self["webpackChunkvue_cms_admin"]=self["webpackChunkvue_cms_admin"]||[]).push([[830],{124:function(e,t,i){i.r(t),i.d(t,{default:function(){return _}});var r=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("菜单权限")])]),t("el-alert",{attrs:{title:"Tips",type:"warning",description:"设置后台管理系统的左侧菜单，目前至多支持两层菜单，三层以上菜单将不会显示。","show-icon":"",closable:!1}}),t("el-table",{staticClass:"am-margin-top",attrs:{data:e.allMenus,"row-key":"permission_id",border:"",stripe:"","default-expand-all":""}},[t("el-table-column",{attrs:{label:"资源名称",width:"200",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[2===i.row.resource_type_id?[t("span",[e._v(e._s(i.row.menu_name))])]:e._e(),3===i.row.resource_type_id?[t("span",[e._v(e._s(i.row.permission_remark))])]:e._e()]}}])}),t("el-table-column",{attrs:{label:"图标"}}),t("el-table-column",{attrs:{label:"资源类型"},scopedSlots:e._u([{key:"default",fn:function(i){return[2===i.row.resource_type_id?[t("el-tag",[e._v(e._s(i.row.resource_type_name))])]:e._e(),3===i.row.resource_type_id?[t("el-tag",{attrs:{type:"warning"}},[e._v(e._s(i.row.resource_type_name))])]:e._e()]}}])}),t("el-table-column",{attrs:{prop:"resource_type_code",label:"资源代码",width:"100"}}),t("el-table-column",{attrs:{prop:"permission_code",label:"权限代码",width:"130"}}),t("el-table-column",{attrs:{prop:"operation_name",label:"操作名称",width:"70"}}),t("el-table-column",{attrs:{prop:"route_name",label:"路由名称",width:"110"}}),t("el-table-column",{attrs:{prop:"route_full_path",label:"完整路由地址",width:"150"}}),t("el-table-column",{attrs:{prop:"menu_order",label:"菜单序号"}}),t("el-table-column",{attrs:{prop:"permission_remark",label:"备注",width:"180"}}),t("el-table-column",{attrs:{label:"操作",width:"230",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{disabled:0===i.row.permission_id,icon:"el-icon-edit",type:"primary",title:"编辑",plain:""},on:{click:function(t){return e.openEditDialog(i.row)}}}),t("el-button",{attrs:{icon:"el-icon-circle-plus-outline",type:"success",title:"添加",plain:""},on:{click:function(t){return e.openInsertDialog(i.row.permission_id,i.row)}}}),t("el-button",{attrs:{disabled:0===i.row.permission_id,icon:"el-icon-setting",type:"warning",title:"设置图标",plain:""}}),t("el-button",{attrs:{disabled:0===i.row.permission_id,icon:"el-icon-delete",type:"danger",title:"删除",plain:""},on:{click:function(t){return e.handleRemoveRoute(i.row)}}})]}}])})],1),t("el-dialog",{attrs:{title:"添加菜单/操作按钮",visible:e.insert_dialog_visible},on:{"update:visible":function(t){e.insert_dialog_visible=t},closed:function(t){return e.handleClosedDialog("insert_form")}}},[t("el-tabs",{attrs:{type:"card"}},[t("el-tab-pane",{attrs:{label:"菜单"}},[t("el-form",{ref:"insert_form",attrs:{model:e.insert_form,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"菜单名称",prop:"menu_name"}},[t("el-input",{model:{value:e.insert_form.menu_name,callback:function(t){e.$set(e.insert_form,"menu_name",t)},expression:"insert_form.menu_name"}})],1),t("el-form-item",{attrs:{label:"是否链接跳转"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.insert_form.is_link,callback:function(t){e.$set(e.insert_form,"is_link",t)},expression:"insert_form.is_link"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.insert_form.is_link,expression:"insert_form.is_link"}],attrs:{label:"关联路由"}},[t("el-cascader",{attrs:{options:e.treeRoutes,props:{value:"route_id",label:"route_name",emitPath:!1},placeholder:"指定此菜单对应的路由"},model:{value:e.insert_form.route_id,callback:function(t){e.$set(e.insert_form,"route_id",t)},expression:"insert_form.route_id"}})],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.insert_form.is_link,expression:"insert_form.is_link"}],attrs:{label:"路由完整路径"}},[t("el-input",{attrs:{placeholder:"指定此菜单的链接地址"},model:{value:e.insert_form.route_full_path,callback:function(t){e.$set(e.insert_form,"route_full_path",t)},expression:"insert_form.route_full_path"}})],1),t("el-form-item",{attrs:{label:"显示顺序",prop:"menu_order"}},[t("el-input",{attrs:{placeholder:"显示顺序按照数字从小到大，如2001"},model:{value:e.insert_form.menu_order,callback:function(t){e.$set(e.insert_form,"menu_order",t)},expression:"insert_form.menu_order"}})],1),t("el-form-item",{attrs:{label:"菜单备注",prop:"menu_order"}},[t("el-input",{attrs:{placeholder:"菜单备注信息"},model:{value:e.insert_form.permission_remark,callback:function(t){e.$set(e.insert_form,"permission_remark",t)},expression:"insert_form.permission_remark"}})],1)],1)],1),t("el-tab-pane",{attrs:{label:"操作按钮"}},[e._v("配置管理")])],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.insert_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleInsertMenu}},[e._v("添 加")])],1)],1),t("el-dialog",{attrs:{title:"编辑节点",visible:e.edit_dialog_visible},on:{"update:visible":function(t){e.edit_dialog_visible=t},closed:function(t){return e.handleClosedDialog("edit_form")}}},[t("el-form",{ref:"edit_form",attrs:{model:e.edit_form,rules:e.rules,"label-width":"80px","label-position":"left"}},[t("el-form-item",{attrs:{label:"菜单名称",prop:"name"}},[t("el-input",{model:{value:e.edit_form.name,callback:function(t){e.$set(e.edit_form,"name",t)},expression:"edit_form.name"}})],1),t("el-form-item",{attrs:{label:"组件名称"}},[t("el-input",{attrs:{placeholder:"指定此菜单对应的组件名称"},model:{value:e.edit_form.component,callback:function(t){e.$set(e.edit_form,"component",t)},expression:"edit_form.component"}})],1),t("el-form-item",{attrs:{label:"链接地址"}},[t("el-input",{attrs:{placeholder:"指定此菜单的链接地址，选填"},model:{value:e.edit_form.path,callback:function(t){e.$set(e.edit_form,"path",t)},expression:"edit_form.path"}})],1),t("el-form-item",{attrs:{label:"显示顺序",prop:"menu_order"}},[t("el-input",{attrs:{placeholder:"显示顺序按照数字从小到大，如2001"},model:{value:e.edit_form.menu_order,callback:function(t){e.$set(e.edit_form,"menu_order",t)},expression:"edit_form.menu_order"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.edit_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleEditMenu}},[e._v("保 存")])],1)],1),t("el-dialog",{attrs:{title:"选择图标",width:"72%",visible:e.icon_modal_visible},on:{"update:visible":function(t){e.icon_modal_visible=t}}},[t("ul",{staticClass:"icon-list"},e._l(e.icons,(function(i){return t("li",{key:i.id,class:{checked:i.checked},on:{click:function(t){return e.handleCheckIcon(i)}}},[t("span",[t("i",{class:`el-icon-${i.name}`}),t("span",{staticClass:"icon-name"},[e._v("el-icon-"+e._s(i.name))])])])})),0),t("el-pagination",{attrs:{background:"",layout:"->,prev, pager, next","page-size":e.pageSize,total:e.total_icon},on:{"current-change":e.handlePageChange}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.icon_modal_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleUpdateIcon}},[e._v("确 定")])],1)],1)],1)],1)},o=[],s=i(629),l=i(1803),n={name:"Menu",data(){return{icon_modal_visible:!1,icons:[],pageSize:30,total_icon:0,checked_icon:{icon_id:"",icon:""},current_node:"",insert_dialog_visible:!1,insert_form:{menu_name:"",is_link:!0,menu_order:"",route_id:"",route_full_path:"",parent_id:"",icon_id:"",permission_remark:""},edit_dialog_visible:!1,edit_form:{menu_name:"",menu_order:"",route_id:"",route_full_path:"",parent_id:"",icon_id:"",permission_remark:""},rules:{menu_name:[{required:!0,type:"string",message:"请输入菜单名称！",trigger:"blur"}],menu_order:[{required:!0,type:"string",message:"请填写显示顺序！",trigger:"blur"},{pattern:/^\d+$/,message:"顺序必须是数字组成！",trigger:"blur"}],route_id:[{message:"请选择与菜单相关联的路由",trigger:"change"}]}}},created(){document.title="菜单权限",this.loadIcons(1),this.loadMenuList({type:"flat"})},computed:{...(0,s.Se)("Route",["treeRoutes","route_full_path"]),...(0,s.Se)("Menu",["allMenus"])},watch:{"insert_form.route_id"(e){this.insert_form.route_full_path=this.route_full_path(e)}},methods:{...(0,s.nv)("Menu",["loadMenuList","createMenu","editMenu","removeMenu"]),openInsertDialog(e,t){this.insert_form.parent_id=e,this.current_route=t,this.insert_dialog_visible=!0},async loadIcons(e){let{status:t,data:i,total:r}=await l.JO.list({pageSize:this.pageSize,pageIndex:e});t&&(i.forEach((e=>{e.checked=!1})),this.icons=i,this.total_icon=r)},handlePageChange(e){this.loadIcons(e)},openIconDialog(e,t){this.icon_modal_visible=!0,this.current_node=e},handleCheckIcon(e){this.icons.forEach((t=>{t.checked=t===e&&!e.checked})),this.checked_icon.icon_id=e.checked?e.id:"",this.checked_icon.icon_name=e.checked?e.name:""},async handleUpdateIcon(){let{id:e}=this.current_node.data,{status:t,msg:i}=await l.v2.setIcon(e,{...this.checked_icon});t&&(this.$message.success(i),this.icon_modal_visible=!1,this.current_node.data.icon_name=this.checked_icon.icon_name)},handleRemoveRoute(){this.$confirm("此操作将永久删除该菜单, 是否继续?",{type:"warning"}).then((async()=>{this.setDefaultExpandedKeys();let{status:e,msg:t}=await l.v2.remove(data.id);e?(node.remove(),this.$message.success(t)):this.$message.error(t)})).catch((()=>{this.$message.info("已取消删除")}))},async handleInsertMenu(){this.$refs.insert_form.validate((async e=>{if(e){this.setDefaultExpandedKeys();let{status:e,msg:t,data:i}=await l.v2.insert({...this.insert_form});e?(this.$refs.tree.append({...this.insert_form,...i},this.current_node),this.$message.success(t),this.insert_dialog_visible=!1):this.$message.error(t)}}))},openEditDialog(e,t){this.edit_dialog_visible=!0,this.edit_form={...t},this.current_node=e},async handleEditMenu(){let{id:e}=this.edit_form;this.$refs.edit_form.validate((async t=>{if(t){let{status:t,msg:i}=await l.v2.update(e,{...this.edit_form});t?(this.current_node.data={...this.edit_form},this.$message.success(i),this.edit_dialog_visible=!1):this.$message.error(i)}}))},handleClosedDialog(e){this.$refs[e].resetFields()}}},a=n,c=i(1001),d=(0,c.Z)(a,r,o,!1,null,"dd405fea",null),_=d.exports}}]);
//# sourceMappingURL=auth-menu.e1f8d3bd.js.map
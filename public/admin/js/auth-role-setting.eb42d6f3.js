"use strict";(self["webpackChunkvue_cms_admin"]=self["webpackChunkvue_cms_admin"]||[]).push([[158],{6806:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("el-card",{},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v("权限设置")])]),t("el-steps",{attrs:{active:e.current_step,"finish-status":"success","align-center":""}},[t("el-step",{attrs:{title:"路由权限"}}),t("el-step",{attrs:{title:"菜单、操作权限"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.current_step,expression:"current_step === 0"}],staticClass:"route-panel"},[t("el-tree",{ref:"route_tree",attrs:{data:e.routes_tree,"check-strictly":e.route_check_strictly,"show-checkbox":"","highlight-current":"","default-expand-all":"","node-key":"route_id"},scopedSlots:e._u([{key:"default",fn:function({node:s,data:r}){return t("div",{staticClass:"custom-tree-node"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:r.route_name,placement:"right"}},[t("span",[e._v(e._s(r.permission_remark))])])],1)}}])})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:1===e.current_step,expression:"current_step === 1"}],staticClass:"menu-panel"},[t("el-tree",{ref:"menu_tree",attrs:{data:e.menus_tree,"check-strictly":e.menu_check_strictly,"show-checkbox":"","highlight-current":"","default-expand-all":"","node-key":"permission_id"},scopedSlots:e._u([{key:"default",fn:function({node:s,data:r}){return t("div",{staticClass:"custom-tree-node"},[2===r.resource_type_id?t("div",{staticClass:"node-menu"},[t("i",{staticClass:"el-icon-notebook-2"}),e._v(" "+e._s(r.menu_name)+" ")]):e._e(),3===r.resource_type_id?t("div",{staticClass:"node-operation"},[t("i",{staticClass:"el-icon-s-operation"}),e._v(" "+e._s(r.permission_remark)+" ")]):e._e()])}}])})],1),t("div",{staticClass:"action-section am-padding-vertical"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:0===e.current_step,expression:"current_step === 0"}],attrs:{type:"primary",size:"medium"},on:{click:e.handleSetRoleRoute}},[e._v("下一步")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:0===e.current_step,expression:"current_step === 0"}],attrs:{plain:"",size:"medium"},on:{click:function(t){return e.$router.back()}}},[e._v("取消")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:1===e.current_step,expression:"current_step === 1"}],attrs:{plain:"",size:"medium"},on:{click:function(t){e.current_step=0}}},[e._v("上一步")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:1===e.current_step,expression:"current_step === 1"}],attrs:{type:"success",size:"medium"}},[e._v("保存设置")])],1)],1)},a=[],i=s(629),n=s(1803),c={name:"Setting",props:["role_id"],data(){return{current_step:0,route_check_strictly:!0,route_checked_keys:[],menu_check_strictly:!0,menu_checked_keys:[]}},computed:{...(0,i.Se)("Route",["routes_tree"]),...(0,i.Se)("Menu",["menus_tree"])},watch:{route_checked_keys:{handler(e,t){console.log(e)},deep:!0}},created(){document.title="设置角色权限",this.handleSetCheckedRoute()},methods:{async handleSetCheckedRoute(){let{status:e,data:t}=await n.uU.route({role_id:this.role_id,type:"flat"});if(e){let e=t.map((e=>e.route_id));this.$refs.route_tree.setCheckedKeys(e),this.route_check_strictly=!1}},handleSetRoleRoute(){let e=this.$refs.route_tree.getCheckedNodes(!1,!0);this.route_checked_keys=e.map((e=>e.permission_id)),this.current_step=1},async handleSetCheckedMenu(){let{status:e,data:t}=await n.uU.menu({role_id:this.role_id,type:"flat"});if(e){let e=t.map((e=>e.id));this.$refs.route_tree.setCheckedKeys(e),this.menu_check_strictly=!1}},async handleSetRoleMenu(){let e=this.$refs.tree.getCheckedNodes(!1,!0),t=e.map((e=>e.id)),{status:s,msg:r}=await n.uU.setMenu({id:this.current_role_id,menus:t});s?(this.$message.success(r),this.setting_visible=!1):this.$message.error(r)}}},u=c,o=s(1001),l=(0,o.Z)(u,r,a,!1,null,"09537b91",null),d=l.exports}}]);
//# sourceMappingURL=auth-role-setting.eb42d6f3.js.map
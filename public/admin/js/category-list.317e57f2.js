"use strict";(self["webpackChunkvue_cms_admin"]=self["webpackChunkvue_cms_admin"]||[]).push([[825],{1816:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v("分类管理")])]),t("el-tree",{ref:"tree",attrs:{"node-key":"cate_id",load:e.loadNode,"default-expanded-keys":[0],"highlight-current":"",lazy:"",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function({node:i,data:s}){return t("div",{staticClass:"custom-tree-node"},[t("span",[e._v(e._s(i.label))]),t("div",[t("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(t){return t.stopPropagation(),e.openEditDialog(i,s)}}},[e._v(" 编辑 ")]),t("el-button",{attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return t.stopPropagation(),e.openInsertDialog(i,s)}}},[e._v(" 添加 ")]),t("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(t){return t.stopPropagation(),e.openRemoveDialog(i,s)}}},[e._v(" 删除 ")])],1)])}}])})],1),t("el-dialog",{attrs:{title:"添加分类",visible:e.insert_dialog_visible},on:{"update:visible":function(t){e.insert_dialog_visible=t},close:function(t){return e.handleCloseDialog("insert_form")}}},[t("el-form",{ref:"insertForm",attrs:{model:e.insert_form,rules:e.rules,"status-icon":"","label-width":"80px"}},[t("el-form-item",{attrs:{label:"分类名称",prop:"cate_name"}},[t("el-input",{model:{value:e.insert_form.cate_name,callback:function(t){e.$set(e.insert_form,"cate_name",t)},expression:"insert_form.cate_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.insert_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleInsert("insertForm")}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"编辑分类",visible:e.edit_dialog_visible},on:{"update:visible":function(t){e.edit_dialog_visible=t},close:function(t){return e.handleCloseDialog("edit_form")}}},[t("el-form",{ref:"editForm",attrs:{model:e.edit_form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"分类名称",prop:"cate_name"}},[t("el-input",{model:{value:e.edit_form.cate_name,callback:function(t){e.$set(e.edit_form,"cate_name",t)},expression:"edit_form.cate_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.edit_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit("editForm")}}},[e._v("确 定")])],1)],1)],1)},a=[],r=(i(7658),i(1803)),o={name:"List",data(){return{defaultProps:{label:"cate_name"},insert_dialog_visible:!1,insert_form:{cate_name:"",parent_id:""},edit_dialog_visible:!1,edit_form:{cate_id:"",cate_name:"",parent_id:""},rules:{cate_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},current_node:""}},created(){document.title="分类管理"},methods:{async loadNode(e,t){let i=[{cate_id:0,cate_name:"全部分类"}];if(0===e.level)return t(i);let{cate_id:s}=e.data,{status:a,data:o}=await r.WD.subcate({cate_id:s});a&&t(o)},openEditDialog(e,t){this.current_node=e,this.edit_form={...t},this.edit_dialog_visible=!0},handleEdit(e){this.$refs[e].validate((async e=>{if(e){let{status:e,msg:t}=await r.WD.edit({...this.edit_form});e?(Object.assign(this.current_node.data,this.edit_form),this.edit_dialog_visible=!1,this.$message.success(t)):this.$message.error(t)}}))},openInsertDialog(e,t){this.current_node=e,this.insert_form.parent_id=t.cate_id,this.insert_dialog_visible=!0},handleInsert(e){this.$refs[e].validate((async e=>{if(e){let{status:e,msg:t,data:i}=await r.WD.insert({...this.insert_form});if(e){let e={...this.insert_form,...i};this.$refs.tree.append(e,this.current_node),this.insert_dialog_visible=!1,this.$message.success(t)}else this.$message.error(t)}}))},openRemoveDialog(e,t){let{cate_id:i}=t;this.$confirm("确定要删除此分类吗？",{type:"warning"}).then((async()=>{let{status:e,msg:s}=await r.WD.remove({cate_id:i});e?(this.$refs.tree.remove(t),this.$message.success(s)):this.$message.error(s)})).catch((()=>{this.$message.info("取消成功！")}))},handleCloseDialog(e){this.$refs[e].resetFields()},setDefaultExpandedKeys(){let e=this.$refs.tree.store._getAllNodes(),t=[];e.forEach((e=>{e.expanded&&t.push(e.data.id)})),this.defaultExpandedKeys=t}}},n=o,l=i(1001),d=(0,l.Z)(n,s,a,!1,null,null,null),c=d.exports}}]);
//# sourceMappingURL=category-list.317e57f2.js.map
"use strict";(self["webpackChunkvue_cms_admin"]=self["webpackChunkvue_cms_admin"]||[]).push([[445],{3546:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var s=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"table-card"},[e("div",{attrs:{slot:"header"},slot:"header"},[e("span",[t._v("文章列表")])]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{prop:"article_id",label:"#",width:"40"}}),e("el-table-column",{attrs:{prop:"cate_1st_name",label:"一级分类"}}),e("el-table-column",{attrs:{prop:"cate_2nd_name",label:"二级分类"}}),e("el-table-column",{attrs:{label:"主图",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-image",{staticStyle:{width:"80px"},attrs:{src:t.row.main_photo,fit:"cover"}})]}}])}),e("el-table-column",{attrs:{prop:"title",label:"标题",width:"250"}}),e("el-table-column",{attrs:{label:"标签",width:"240"},scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.row.tags,(function(a){return e("el-tag",{key:a.id,staticClass:"am-margin-right-sm",attrs:{type:"success"}},[t._v(" "+t._s(a.tag_name)+" ")])}))}}])}),e("el-table-column",{attrs:{prop:"create_time",label:"发布日期",width:"90"}}),e("el-table-column",{attrs:{prop:"update_time",label:"更新日期",width:"90"}}),e("el-table-column",{attrs:{label:"操作",fixed:"right",width:"190"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"am-padding-bottom-sm"},[e("el-link",{staticClass:"am-margin-right-sm",attrs:{href:`#/article/edit/${a.row.article_id}`,underline:!1,type:"primary"}},[e("el-button",{attrs:{icon:"el-icon-edit",type:"primary",plain:""}},[t._v("编辑")])],1),e("el-button",{attrs:{icon:"el-icon-collection-tag",type:"success",plain:""},on:{click:function(e){return t.openTagDialog(a.row)}}},[t._v(" 标记 ")])],1),e("div",[e("el-button",{attrs:{icon:"el-icon-collection-tag",type:"warning",plain:""}},[t._v(" 审核 ")]),e("el-button",{attrs:{icon:"el-icon-delete",type:"danger",plain:""},on:{click:function(e){return t.handleRemoveArticle(a.row.article_id,a.$index)}}},[t._v(" 删除 ")])],1)]}}])})],1),e("el-dialog",{attrs:{title:"标记文章",visible:t.tag_dialog_visible},on:{"update:visible":function(e){t.tag_dialog_visible=e},close:function(e){return t.handleDialogClose("search_form")}}},[e("div",{staticClass:"tag-tip am-margin-bottom-lg"},[e("div",{staticClass:"left"},[t._v("您可以添加多个标签：")]),e("div",{staticClass:"right"},[e("el-form",{ref:"search_form",staticClass:"am-margin-right-sm",attrs:{model:t.search_form,rules:t.rules}},[e("el-form-item",{staticClass:"am-margin-bottom-0",attrs:{prop:"reply"}},[e("el-input",{attrs:{placeholder:"找不到标签?请在此处搜索"},model:{value:t.search_form.keyword,callback:function(e){t.$set(t.search_form,"keyword",e)},expression:"search_form.keyword"}},[e("el-button",{attrs:{slot:"append",icon:"search"},slot:"append"})],1)],1)],1),e("el-button",{attrs:{type:"success",icon:"el-icon-circle-plus-outline",plain:""}},[t._v("创建标签")])],1)]),e("div",{staticClass:"tag-input"},t._l(t.selected_tags,(function(a,s){return e("el-tag",{key:a.tag_id,attrs:{closable:"",type:"success",effect:"dark"},on:{close:function(e){return t.handleCloseTag(s)}}},[t._v(" "+t._s(a.tag_name)+" ")])})),1),e("div",{staticClass:"tag-list am-margin-top-lg"},t._l(t.tags_list,(function(a){return e("el-tag",{key:a.tag_id,attrs:{type:"success"},on:{click:function(e){return t.handleSelectTag(a)}}},[t._v(" "+t._s(a.tag_name)+" ")])})),1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"success",plain:""},on:{click:function(e){t.tag_dialog_visible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"success"},on:{click:t.handleTagArticle}},[t._v("保 存")])],1)])],1)},l=[],i=(a(7658),a(1862)),r={name:"List",data(){return{tableData:[],tags_list:[],selected_tags:[],current_article:{},search_form:{keyword:""},rules:{keyword:[{required:!0,message:"请输入搜索的关键词",trigger:"blur"}]},tag_dialog_visible:!1}},created(){document.title="文章列表",this.loadList(),this.loadTags()},methods:{async loadList(){let{status:t,data:e,total:a}=await i.d2.list({pageindex:1,pagesize:30});t&&(this.tableData=e)},async loadTags(){let{status:t,data:e,total:a}=await i.Vp.list();t&&(this.tags_list=e)},handleRemoveArticle(t,e){this.$confirm("此操作将永久删除该文章, 是否继续?",{type:"warning"}).then((async()=>{let{status:a,msg:s}=await i.d2.remove({article_id:t});a&&(this.tableData.splice(e,1),this.$message.success(s))}))},openTagDialog(t){this.current_article=t,this.selected_tags=[...t.tags],this.tag_dialog_visible=!0},async handleTagArticle(){let{article_id:t}=this.current_article,e=this.selected_tags.map((t=>t.tag_id)),{status:a,msg:s}=await i.d2.tag({article_id:t,tags:e});a?(this.current_article.tags=[...this.selected_tags],this.tag_dialog_visible=!1,this.$message.success(s)):this.$message.error(s)},handleSelectTag(t){let e=this.selected_tags.findIndex((e=>e.tag_id===t.tag_id))>=0;e||this.selected_tags.push({...t})},handleCloseTag(t){this.selected_tags.splice(t,1)},handleDialogClose(t){this.$refs[t].resetFields()}}},n=r,c=a(1001),o=(0,c.Z)(n,s,l,!1,null,null,null),d=o.exports}}]);
//# sourceMappingURL=article-list.f133a3c1.js.map
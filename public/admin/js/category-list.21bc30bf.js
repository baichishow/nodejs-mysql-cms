"use strict";(self["webpackChunkvue_cms_admin"]=self["webpackChunkvue_cms_admin"]||[]).push([[825],{6449:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v("分类列表")])]),t("el-tree",{ref:"tree",attrs:{"node-key":"cate_id",load:e.loadNode,"default-expanded-keys":[0],"highlight-current":"",lazy:"",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function({node:i,data:a}){return t("span",{staticClass:"custom-tree-node"},[t("span",[e._v(e._s(i.label))]),t("span",[t("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(t){return t.stopPropagation(),e.openEditDialog(i,a)}}},[e._v(" 编辑 ")]),t("el-button",{attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return t.stopPropagation(),e.openInsertDialog(i,a)}}},[e._v(" 添加 ")]),t("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(t){return t.stopPropagation(),e.openRemoveDialog(i,a)}}},[e._v(" 删除 ")])],1)])}}])})],1),t("el-dialog",{attrs:{title:"添加分类",visible:e.insert_dialog_visible},on:{"update:visible":function(t){e.insert_dialog_visible=t}}},[t("el-form",{ref:"insertForm",attrs:{model:e.insert_form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"分类名称",prop:"cate_name"}},[t("el-input",{model:{value:e.insert_form.cate_name,callback:function(t){e.$set(e.insert_form,"cate_name",t)},expression:"insert_form.cate_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.insert_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleInsert("insertForm")}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"编辑分类",visible:e.edit_dialog_visible},on:{"update:visible":function(t){e.edit_dialog_visible=t}}},[t("el-form",{ref:"editForm",attrs:{model:e.edit_form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"分类名称",prop:"cate_name"}},[t("el-input",{model:{value:e.edit_form.cate_name,callback:function(t){e.$set(e.edit_form,"cate_name",t)},expression:"edit_form.cate_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.edit_dialog_visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit("editForm")}}},[e._v("确 定")])],1)],1)],1)},s=[],o=(i(7658),i(1803)),n={name:"List",data(){return{defaultProps:{label:"cate_name"},insert_form:{cate_name:"",parent_id:""},edit_form:{cate_id:"",cate_name:"",parent_id:""},rules:{cate_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},node:{},insert_dialog_visible:!1,edit_dialog_visible:!1}},created(){document.title="分类列表"},methods:{async loadNode(e,t){if(0===e.level)return t([{cate_name:"全部分类",cate_id:0}]);let{cate_id:i}=e.data,{status:a,data:s}=await o.WD.subcate({cate_id:i});a&&t(s)},openEditDialog(e,t){this.node=e,this.edit_form={...t},this.edit_dialog_visible=!0},handleEdit(e){this.$refs[e].validate((async e=>{if(e){let{status:e,msg:t}=await o.WD.edit({...this.edit_form});e?(this.$message.success(t),this.edit_dialog_visible=!1,this.node.data=this.edit_form):this.$message.error(t)}}))},openInsertDialog(e,t){this.insert_form.parent_id=t.cate_id,this.node=e,this.insert_dialog_visible=!0},handleInsert(e){this.$refs[e].validate((async e=>{if(e){let{status:e,msg:t,data:i}=await o.WD.insert({...this.insert_form});e&&(this.insert_dialog_visible=!1,this.$refs.tree.append({...this.insert_form,...i},this.node))}}))},openRemoveDialog(e,t){this.$confirm("确定要删除此分类吗？",{type:"warning"}).then((async()=>{let{status:e,msg:i}=await o.WD.remove({cate_id:t.cate_id});e?(this.$refs.tree.remove(t),this.$message.success(i)):this.$message.error(i)})).catch((()=>{this.$message.info("取消成功！")}))},setDefaultExpandedKeys(){let e=this.$refs.tree.store._getAllNodes(),t=[];e.forEach((e=>{e.expanded&&t.push(e.data.id)})),this.defaultExpandedKeys=t}}},r=n,l=i(1001),d=(0,l.Z)(r,a,s,!1,null,null,null),c=d.exports}}]);
//# sourceMappingURL=category-list.21bc30bf.js.map